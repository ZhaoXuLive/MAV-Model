%% explain
% k defines the type of test
%   1 = step-steer
%   2 = ramp (slowly increasing steer)
%   3 = random-steer
%   4 = sinus
% swa_in at the steering wheel, in radians

k = 3;

deg = pi/180;
T = 100; 

%% choose situation
switch k
    % step
    case 1 
        t0 = 5; 
        amp = 20 * deg; 
        dt = 0.2;
        pts = [0 0
               t0 0
               t0 + dt,amp
               T, amp];
    % ramp
    case 2 
        t0 = 2; 
        amp = 180 * deg;
        tf = 50;
        pts = [0 0
               t0 0
               tf amp
               T amp];
    % random steer    
    case 3 
        t0 = 2;
        dt = 0.1;
        tf = t0 + 30;
        stdev = 10 * deg;
        n = round((tf - t0) / dt);
        tvec = (1:n)' * dt;
        strvec = stdev * randn(size(tvec));
        pts = [0 0
               t0 0
               t0 + tvec, strvec
               tf + dt 0
               T 0];
    % series of sinusoids (can comment out those not needed)    
    case 4 
        t0 = 4;
        dt = 0.01;
        % amplitudes and frequencies set below
        f = 0.5;
        tvec1 = (0:dt:20/f)';
        strvec1 = 5*deg*sin(2*pi*f*tvec1);
        pts = [0 0
               t0 0
               t0 + dt + tvec1, strvec1];
        tf = pts(end, 1);
        pts = [pts
               tf + dt, 0
               T 0];
    % series of sinusoids (can comment out those not needed)
    case 5 
        t0 = 4;
        dt = 0.01;
        % amplitudes and frequencies set below
        f = 1.0;
        tvec2 = (0:dt:40/f)';
        strvec2 = 5*deg*sin(2*pi*f*tvec2);
        pts = [0 0
               t0 0
               t0 + dt + tvec2, strvec2];
        tf = pts(end, 1);
        pts = [pts
               tf + dt, 0
               T 0];
    % series of sinusoids (can comment out those not needed)
    case 6 
        t0 = 4;
        dt = 0.01;
        % settling time between cycles
        ts = 8; 
        % amplitudes and frequencies set below
        f = 0.5;
        tvec1 = (0:dt:20/f)';
        strvec1 = 10*deg*sin(2*pi*f*tvec1);
        pts = [0 0
               t0 0
               t0 + dt + tvec1, strvec1];
        tf = pts(end, 1);
        pts = [pts
               tf + dt, 0
               T 0];
     % series of sinusoids (can comment out those not needed)
     case 7 
        t0 = 4;
        dt = 0.01;
        % amplitudes and frequencies set below
        f = 2;
        tvec2 = (0:dt:80/f)';
        strvec2 = 5*deg*sin(2*pi*f*tvec2);
        pts = [0 0
               t0 0
               t0 + dt + tvec2, strvec2];
        tf = pts(end, 1);
        pts = [pts
               tf+dt, 0
               T 0];
     % lane change sinus
     case 8 
        t0 = 2;
        dt = 0.01;
        % amplitudes and frequencies set below
        f = 0.3;
        tvec1 = (0:dt:1/f)';
        strvec1 = 70*deg*sin(2*pi*f*tvec1);
        pts = [0 0
               t0 0
               t0 + dt + tvec1, strvec1];
        tf = pts(end, 1);
        pts = [pts
               tf + dt, 0
               T 0];
      % square wave  
      case 9 
        t0 = 10; 
        amp = 45*deg; 
        dt = 5;
        ddt = 0.2;
        pts = [0 0
               t0 0
               t0 + ddt, amp
               t0 + dt, amp
               t0 + dt + ddt, -amp
               t0 + 2*dt, -amp
               t0 + 2*dt + ddt,amp
               t0 + 3*dt, amp
               t0 + 3*dt + ddt, -amp
               t0 + 4*dt, amp
               t0 + 4*dt + ddt, amp
               t0 + 5*dt, amp
               t0 + 5*dt + ddt, -amp
               t0 + 6*dt, -amp
               t0 + 6*dt + ddt, 0
               T, 0];
end

t_in = pts(:, 1)';
swa_in = pts(:, 2)';
            
%% test/plot the function

% plot(t_in, swa_in*180/pi);

tstr_in = (0:0.01:100)';
str_in = interp1(t_in, swa_in, tstr_in, 'linear', 'extrap');
plot(tstr_in, str_in*180/pi);


